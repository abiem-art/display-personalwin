<script>
    const baseUrls = [
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vTEVx5HcjpuYcqS0T_bK7-tl9RbaFanW_aqL1pjOxA0KpiluTTkuo_yqgHI_6jM8x33S2M1dR81iCsM/pubhtml?gid=0&single=true",
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vTEVx5HcjpuYcqS0T_bK7-tl9RbaFanW_aqL1pjOxA0KpiluTTkuo_yqgHI_6jM8x33S2M1dR81iCsM/pubhtml?gid=639726083&single=true",
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vTEVx5HcjpuYcqS0T_bK7-tl9RbaFanW_aqL1pjOxA0KpiluTTkuo_yqgHI_6jM8x33S2M1dR81iCsM/pubhtml?gid=175662834&single=true",
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vTEVx5HcjpuYcqS0T_bK7-tl9RbaFanW_aqL1pjOxA0KpiluTTkuo_yqgHI_6jM8x33S2M1dR81iCsM/pubhtml?gid=1727077156&single=true",
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vTEVx5HcjpuYcqS0T_bK7-tl9RbaFanW_aqL1pjOxA0KpiluTTkuo_yqgHI_6jM8x33S2M1dR81iCsM/pubhtml?gid=665317593&single=true",
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vTEVx5HcjpuYcqS0T_bK7-tl9RbaFanW_aqL1pjOxA0KpiluTTkuo_yqgHI_6jM8x33S2M1dR81iCsM/pubhtml?gid=1927959927&single=true"
    ];

    let currentIndex = 0;
    const container = document.getElementById('frame-container');
    const pageNum = document.getElementById('page-num');

    function rotate() {
        // Hapus iframe lama sepenuhnya untuk memaksa GPU NVIDIA merender ulang
        container.innerHTML = ""; 
        
        const newIframe = document.createElement('iframe');
        const cacheBuster = "&cb=" + new Date().getTime();
        
        newIframe.src = baseUrls[currentIndex] + cacheBuster;
        newIframe.id = "display-frame";
        
        container.appendChild(newIframe);
        
        pageNum.innerText = currentIndex + 1;
        currentIndex = (currentIndex + 1) % baseUrls.length;
        
        // Reset Progress Bar
        const progressBar = document.getElementById('progress-bar');
        progressBar.style.transition = 'none';
        progressBar.style.width = '0%';
        setTimeout(() => {
            progressBar.style.transition = 'width 30s linear';
            progressBar.style.width = '100%';
        }, 100);
    }

    rotate();
    setInterval(rotate, 30000);
</script>
